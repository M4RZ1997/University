\documentclass{article}
\usepackage{geometry}
\usepackage{paralist}
\usepackage[T1]{fontenc}
\usepackage{reledmac}
\usepackage{changepage}

\usepackage{pgfplots}
\usepackage{tikz}
\usetikzlibrary{positioning}
\usetikzlibrary{shapes.geometric, arrows}
\tikzstyle{arrow} = [thick,->,>=stealth]

\usepackage{fancyhdr}
\fancyhead[L]{
	\begin{tabular}{l}
		\LARGE \textbf{\textsc{Distributed Algorithms}} \\
		\Large Exercise 02
	\end{tabular}
}
\fancyhead[R]{
	\begin{tabular}{r}
		16-124-836 \\
		Marcel \textsc{Zauder}
	\end{tabular}
}
\renewcommand{\headrulewidth}{0.4pt}
\fancyfoot[C]{\thepage}
\renewcommand{\footrulewidth}{0.4pt}

\usepackage{hyperref}

\begin{document}
	\pagestyle{fancy}
	
	\section*{2.1 Pizza or Pasta}
	\begin{adjustwidth}{-3em}{}
		\begin{tabular}{lllll}
			\begin{tabular}{|l|}
				\hline
				\textbf{Module \textsc{Alice}:} \\
				\hline
				\underline{Init:} \\
				\ \ $\textit{custPizzaBuffer} \ = \ \emptyset$ \\
				\ \ $\textit{custPastaBuffer} \ = \ \emptyset$ \\
				\ \ $\textit{pizzaBuffer} \ = \ \emptyset$ \\
				\ \ $\textit{pastaBuffer} \ = \ \emptyset$ \\
				\\
				\underline{upon} $\langle \textit{Bob, getJob} \mid \textsc{Null} \rangle$ \\
				\ \ \underline{while} ($pizzaBuffer == \emptyset$) \{\} \\
				\ \ $\textit{dish} \leftarrow \textit{pizzaBuffer}$ \\
				\ \ trigger $\langle \textit{Bob, prepareDish} \mid dish \rangle$ \\
				\\
				\underline{upon} $\langle \textit{Carole, getJob} \mid \textsc{Null} \rangle$ \\
				\ \ \underline{while} ($pastaBuffer == \emptyset$) \{\} \\
				\ \ $\textit{dish} \leftarrow \textit{pastaBuffer}$ \\
				\ \ trigger $\langle \textit{Carole, prepareDish} \mid dish \rangle$ \\
				\\
				\underline{upon} $\langle \textit{Customer, orderDish} \mid \textit{customer, menu} \rangle$ \underline{do} \\
				\ \ \underline{if} (\textit{menu}.sortOf(Pizza)) \\
				\ \ \ \ $\textit{custPizzaBuffer} \ = \ \textit{custPizzaBuffer} \cup \textit{customer}$ \\
				\ \ \ \ $\textit{pizzaBuffer} \ = \ \textit{pizzaBuffer} \cup \textit{menu}$ \\
				\ \ \underline{else} \\
				\ \ \ \ $\textit{custPastaBuffer} \ = \ \textit{custPastaBuffer} \cup \textit{customer}$ \\
				\ \ \ \ $\textit{pastaBuffer} \ = \ \textit{pastaBuffer} \cup \textit{menu}$ \\
				\\
				\underline{upon} $\langle \textit{Bob, returnDish} \mid \textit{menu} \rangle$ \underline{do} \\
				\ \ $\textit{customer} \leftarrow \textit{custPizzaBuffer}$ \\
				\ \ $\textit{custPizzaBuffer} \ = \ \textit{custPizzaBuffer} \setminus \textit{customer}$ \\
				\ \ trigger $\langle \textit{Alice, serveDish} \mid \textit{customer, menu} \rangle$ \\
				\\
				\underline{upon} $\langle \textit{Carole, returnDish} \mid \textit{menu} \rangle$ \underline{do} \\
				\ \ $\textit{customer} \leftarrow \textit{custPastaBuffer}$ \\
				\ \ $\textit{custPastaBuffer} \ = \ \textit{custPastaBuffer} \setminus \textit{customer}$ \\
				\ \ trigger $\langle \textit{Alice, serveDish} \mid \textit{customer, menu} \rangle$ \\
				\hline
			\end{tabular}
			&
			&
			\begin{tabular}{l}
				\begin{tabular}{|l|}
					\hline
					\textbf{Module \textsc{Bob}:} \\
					\hline
					\underline{Init:} \\
					\ \ $\textit{bobPizzaBuffer} \ = \ \emptyset$ \\
					\ \ $\textit{triggerCounter} \ = \ 0$ \\
					\\
					\underline{while} (\textsc{True}) \\
					\ \ \underline{if} $\mid \textit{bobPizzaBuffer} \mid + \textit{triggerCounter} < 3$ \\
					\ \ \ \ trigger $\langle \textit{Bob, getJob} \mid \textsc{Null} \rangle$ \\
					\ \ \ \ $\textit{triggerCounter}++$ \\
					\ \ \underline{if} ($\mid \textit{bobPizzaBuffer} \mid \neq 0$) \\
					\ \ \ \ $\textit{dish} \leftarrow \textit{bobPizzaBuffer}$ \\
					\ \ \ \ \textit{prepare the dish} \\
					\ \ \ \ $\textit{bobPizzaBuffer} \ = \ \textit{bobPizzaBuffer} \setminus \textit{dish}$ \\
					\ \ \ \ trigger $\langle \textit{Bob, returnDish} \mid dish \rangle$ \\
					\\
					\underline{upon} $\langle \textit{Bob, prepareDish} \mid \textit{dish} \rangle$ \\
					\ \ $\textit{bobPizzaBuffer} \ = \ \textit{bobPizzaBuffer} \cup \textit{dish}$ \\
					\ \ $\textit{triggerCounter} \ -= 1$ \\
					\hline
				\end{tabular}
				\\
				\\
				\begin{tabular}{|l|}
					\hline
					\textbf{Module \textsc{Carole}:} \\
					\hline
					\underline{Init:} \\
					\ \ $\textit{carolePastaBuffer} \ = \ \emptyset$ \\
					\ \ $\textit{triggerCounter} \ = \ 0$ \\
					\\
					\underline{while} (\textsc{True}) \\
					\ \ \underline{if} $\mid \textit{carolePastaBuffer} \mid + \textit{triggerCounter} < 7$ \\
					\ \ \ \ trigger $\langle \textit{Carole, getJob} \mid \textsc{Null} \rangle$ \\
					\ \ \ \ $\textit{triggerCounter}++$ \\
					\ \ \underline{if} ($\mid \textit{carolePastaBuffer} \mid \neq 0$) \\
					\ \ \ \ $\textit{dish} \leftarrow \textit{carolePastaBuffer}$ \\
					\ \ \ \ \textit{prepare the dish} \\
					\ \ \ \ $\textit{carolePastaBuffer} \ = \ \textit{carolePastaBuffer} \setminus \textit{dish}$ \\
					\ \ \ \ trigger $\langle \textit{Carole, returnDish} \mid dish \rangle$ \\
					\\
					\underline{upon} $\langle \textit{Carole, prepareDish} \mid \textit{dish} \rangle$ \\
					\ \ $\textit{carolePastaBuffer} \ = \ \textit{carolePastaBuffer} \cup \textit{dish}$ \\
					\ \ $\textit{triggerCounter} \ -= 1$ \\
					\hline
				\end{tabular}
			\end{tabular}
		\end{tabular}			
	\end{adjustwidth}
	\newpage
	\section*{2.2 Safety and liveness}
	\begin{adjustwidth}{2em}{2em}	
		\begin{enumerate}[(a)]
			\item \textit{If some general attacks at time $t$, then the other general attacks at the same time.} \\
			This is a \textit{\textbf{safety property}}, because it ensures that if any general is attacking at time $t$ there was nothing bad happening before. If for example messenger $m_2$ was delayed or intercepted General A would not have attacked at time $t$ as General B would have.
			\item \textit{If $m_2$ arrives after time $t$, then General A attack after General B.} \\
			This is a \textit{\textbf{safety property}}, because this statement ensures that General A will attack if and only if it receives the message delivered by $m_2$ and not just out of thin air.
			\item \textit{Eventually, General B will attack.} \\
			This is a \textit{\textbf{liveness property}}, because it says that eventually something good will happen.
			\item \textit{If messenegers $m_1$ and $m_2$ are not intercepted, then eventually both generals attack.} \\
			This is a \textit{\textbf{liveness property}}, because we can consider an execution $E$ in which non messenger is intercepted. Therfore we can consider a prefix $E'$ where $m_2$ is arriving at General A before time $t$, which then always leads to both generals attacking at the same time $t$.
			\item \textit{If $m_1$ and $m_2$ are not intercepted, then eventually both generals attack at time $t$.} \\
			This is a \textit{\textbf{mixture}}, because we have the safety property that both messenger will arrive in time - so before time $t$ - and the liveness property that eventually both attack at the same time $t$.
		\end{enumerate}			
	\end{adjustwidth}
	
	\section*{2.3 Unreliable clocks}
	\begin{adjustwidth}{2em}{2em}
		\begin{enumerate}[(a)]
			\item \textit{Find two examples, where timing issues lead to safety violations.} \\
			As a first example, we can take the case from exercise 2.2. We consider that the clock of General B is delayed behind the one from General A. So if messenger $m_2$ is arriving after time $t$, but General B's is so much delayed, that General A is still attacking before him, so the safety properties are violated. \\
			As a second example, we can consider an automatic airplane scheduling system. We assume that each plane is on time and due to time the destination is set. The scheduling system is also stating the destination on each gate. Therefore if the planes' clocks and the system clock are out of sync, the safety property is violated.
			\item \textit{Find two examples, where timing issues lead to liveness volations.} \\
			As a first example, we can take the case from exercise 2.2. If General A and General B have clocks with timing issues, they could agree on a time that is not the same in reality. So both general cannot attack at the same time. \\
			As a second example, we can again consider the automatic airplane scheduling system. If the clocks of an airplane and the system are out of sync so that the system thinks that the plane is going to destination "A" but in reality it is going to destination "B", the liveness property is violated.
		\end{enumerate}			
	\end{adjustwidth}
\end{document}