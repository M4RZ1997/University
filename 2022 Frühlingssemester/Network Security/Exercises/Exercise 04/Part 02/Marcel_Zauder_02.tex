\documentclass{report}

\usepackage{../../../../../LaTeX/marzstyle}

\newcommand{\exercisenr}{4}

\runningheads{Network Security}{Exercise 0\exercisenr}

\setcounter{chapter}{\exercisenr}
\setcounter{section}{1}


\begin{document}
	\section{Question 2}
	\startsection
		\renewcommand{\thesubsection}{\thesection.\Alph{subsection}}
		\subsection{Consider the following hash function. Messages are in the form of a sequence of numbers in $\fancyletter{Z}_n, \ M \ = \ (a_1a_2...a_t)$. The hash value is calculated as $\sum_{i=1}^t a_i$ for some predefined value $n$. Does this hash function satisfy any of the requirements for a hash function listed in Table 1.}
		\startsubsection
			The \textit{Variable Input Size}, \textit{Fixed Output Size}, and \textit{Efficiency} properties are all satisfied. The fourth property, \textit{Preimage Resistant (One-Way Property)}, is not fulfilled as a message only consisting of the value $h$ has the hash-value $H(h) \ = \ h$. Also property 5, \textit{Second Preimage Resistant (Weak Collision Resistant)}, is not fulfilled as to any message M the decimal digit $0$ can be added to the sequence; leading to the same hash value. Hence, also property 6 is not satisfied.
		\closesection
		\subsection{Repeat part (A) for the hash function $h \ = \ \left(\sum_{i=1}^t (a_i)^2\right) \ mod \ n$.}
		\startsubsection
			Again the \textit{Variable Input Size}, \textit{Fixed Output Size}, and \textit{Efficiency} properties are all satisfied. Property 4 is also satisfied if $n$ is a large composite number, because taking square roots modulo such an integer $n$ is considered to be infeasible. Properties 5 and 6 are not satisfied as "$-M$" will have the same hash value as $M$ for instance.
		\closesection
		\subsection{Calculate the hash function of part (B) for $M \ = \ (189, \ 632, \ 900, \ 722, \ 349)$ and $n \ = \ 989$.}
		\vspace*{-2em}
		\begin{align*}
			h \ & = \ \left(\sum_{i=1}^5 (a_i)^2\right) \ mod \ 989 \\
			& = \ (189^2 + 632^2 + 900^2 + 722^2 + 349^2) \ mod \ 989 \\
			& = \ (35'721 + 399'424 + 810'000 + 521'284 + 121'801) \ mod \ 989 \\
			& = \ 1'888'230 \ mod \ 989 \\
			& = \ 229
		\end{align*}
	\closesection
	
	\section{Question 3}
	\startsection
		\renewcommand{\thesubsection}{\thesection.\Alph{subsection}}
		\subsection{State the value of the padding field in SHA-512 if the length of the message is:}
		\startsubsection
			\subsubsection{5000 bits}
			\startsubsection
				\begin{enumerate}
					\item Calculate size of the data in the last block:
					\[
						5000 \ mod \ 1024 \ = \ 904
					\]
					\item Add the size of the length field (128 bit) to the last block size:
					\[
						904 + 128 \ = \ 1032
					\]
					\item Because $1032 > 1024$ the last block is now:
					\[
						1032 \ mod \ 1024 \ = \ 8
					\]
					\item The length of the padding field is therefore:
					\[
						1024 - 8 \ = \ 1016 \textit{ bits}
					\]
					\item Therefore the padding consists of one 1 and 1015 zeros, hence the value is:
					\[
						\textit{Value of Padding:} \ 2^{1015}
					\]
				\end{enumerate}
			\closesection
			\subsubsection{5001 bits}
			\startsubsection
				\begin{enumerate}
					\item Calculate size of the data in the last block:
					\[
						5001 \ mod \ 1024 \ = \ 905
					\]
					\item Add the size of the length field (128 bit) to the last block size:
					\[
						905 + 128 \ = \ 1033
					\]
					\item Because $1032 > 1024$ the last block is now:
					\[
						1033 \ mod \ 1024 \ = \ 9
					\]
					\item The length of the padding field is therefore:
					\[
						1024 - 9 \ = \ 1015 \textit{ bits}
					\]
					\item Therefore the padding consists of one 1 and 1014 zeros, hence the value is:
					\[
						\textit{Value of Padding:} \ 2^{1014}
					\]
				\end{enumerate}
			\closesection
			\subsubsection{5002 bits}
			\startsubsection
				\begin{enumerate}
					\item Calculate size of the data in the last block:
					\[
						5002 \ mod \ 1024 \ = \ 906
					\]
					\item Add the size of the length field (128 bit) to the last block size:
					\[
						906 + 128 \ = \ 1034
					\]
					\item Because $1032 > 1024$ the last block is now:
					\[
						1034 \ mod \ 1024 \ = \ 10
					\]
					\item The length of the padding field is therefore:
					\[
						1024 - 10 \ = \ 1014 \textit{ bits}
					\]
					\item Therefore the padding consists of one 1 and 1013 zeros, hence the value is:
					\[
						\textit{Value of Padding:} \ 2^{1013}
					\]
				\end{enumerate}
			\closesection
		\closesection
		\subsection{State the value of the length field in SHA-512 if the length of the message is:}
		\startsubsection
			\subsubsection{5000 bits}
			\startsubsection
				0x00000000000000000000000000001388
			\closesection
			\subsubsection{5001 bits}
			\startsubsection
				0x00000000000000000000000000001389
			\closesection
			\subsubsection{5002 bits}
			\startsubsection
				0x0000000000000000000000000000138A
			\closesection
		\closesection
	\closesection
	
	\section{Question 4}
	\startsection
		\renewcommand{\thesubsection}{\thesection.\Alph{subsection}}
		\subsection{Explain the differences in the algorithms of SHA-3 and MD-5. Which one is used today? Why?}
		\startsubsection
		\closesection
	\closesection
\end{document}